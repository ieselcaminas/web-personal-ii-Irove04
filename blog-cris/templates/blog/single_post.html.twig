{% extends 'base.html.twig' %}

{% block title %}{{ post ? post.title : 'Post no encontrado' }}{% endblock %}

{% block body %}
    <div class="center">
        {% if not post %}
            <div class="center1">
                <h2 class="cp_title">404 - Post not found</h2>
                <p style="color: #484848;">Lo sentimos, la entrada que buscas no existe.</p>
                <a href="{{ path('index') }}" style="color: #00AEEF;">Volver al inicio</a>
            </div>
        {% else %}
            {# Contenedor principal con Flexbox para a√±adir el sidebar #}
            <div style="display: flex; flex-wrap: wrap; gap: 30px; justify-content: center; max-width: 1200px; margin: 0 auto;">

                {# COLUMNA IZQUIERDA: El post actual #}
                <div class="center1" style="flex: 2; min-width: 300px; margin: 0;">
                    <h2 class="cp_title">{{ post.title }}</h2>

                    <div style="margin: 20px 0;">
                        {% if post.image %}
                            <img src="{{ asset('images/index/gallery/' ~ post.image) }}" alt="{{ post.title }}" style="width: 100%; border: 2px solid #2e6ab2;">
                        {% endif %}
                    </div>

                    <p style="color: #5e5e5e; font-size: 12px;">
                        Publicado por: <strong>{{ post.postUser ? post.postUser.email : 'Usuario desconocido' }}</strong> |
                        Fecha: {{ post.publishedAt | date('d') }} de {{ post.publishedAt | date('F') }}
                    </p>

                    <hr style="opacity: 0.2; margin: 20px 0;">

                    <div style="color: #252525; line-height: 1.6; text-align: justify; margin-bottom: 30px;">
                        {{ post.content | nl2br }}
                    </div>

                    <a href="{{ path('posts') }}" class="btn-windows" style="text-decoration: none;">
                        <span style="color: black;">< VOLVER AL LISTADO</span>
                    </a>
                </div>

                {# COLUMNA DERECHA: Posts Recientes #}
                <aside style="flex: 1; min-width: 250px; background: rgba(255,255,255,0.05); padding: 20px; border: 1px solid #ddd; height: fit-content;">
                    <h3 style="color: #2e6ab2; border-bottom: 2px solid #2e6ab2; padding-bottom: 10px; margin-top: 0;">Post Recientes</h3>

                    <div style="display: flex; flex-direction: column; gap: 15px; margin-top: 20px;">
                        {% for recent in recents %}
                            {# Evitamos mostrar el mismo post que ya estamos leyendo #}
                            {% if recent.id != post.id %}
                                <div style="display: flex; gap: 10px; align-items: center; border-bottom: 1px dashed #ccc; padding-bottom: 10px;">
                                    {% if recent.image %}
                                        <img src="{{ asset('images/index/gallery/' ~ recent.image) }}" style="width: 60px; height: 60px; object-fit: cover; border: 1px solid #2e6ab2;">
                                    {% endif %}

                                    <div>
                                        <a href="{{ path('single_post', {slug: recent.slug}) }}" style="text-decoration: none; color: #252525; font-weight: bold; font-size: 14px; display: block;">
                                            {{ recent.title }}
                                        </a>
                                        <small style="color: #888;">{{ recent.publishedAt | date('d/m/Y') }}</small>
                                    </div>
                                </div>
                            {% endif %}
                        {% endfor %}
                    </div>
                </aside>

            </div>
        {% endif %}
    </div>
{% endblock %}